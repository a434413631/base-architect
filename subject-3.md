## 第三章节 开关
集中化管理各类开关  
<img src="img/subject-2.jpeg" width="500"/>

### 3.1 动态开关
通过键名获取变量 让其第一时间告知应用群或各个业务系统 并通过分布式锁(第二章)方式加锁避免冲突   
通过服务治理中心广播或插件形式主动访问形式 可定制开关缓存时间减少对中心的访问  
开关可大大的提升可用性 也可在一定程度可减少开发需求

### 3.2 系统开关
用于系统级别的开关 此开关通常用于解决系统一些故障问题灾难或突发性高频访问等等   
场景例子:  
1) 打开/关闭所有日志输出或输出到elk  
2) 打开/关闭使用外部缓存或中间件  
3) 切换机房/网络(类似多活)  
4) 子系统故障切换模式或直接降级  
5) 灾难问题 可以将非关键的整体系统下线或降级开关  
6) 单/双写数据库切换或是否写入大数据  
7) 全局需变更的配置/参数

### 3.3 应用开关
用于应用基础框架或第三方组件的内置开关  
针对单个应用或应用集群的开关模式  
场景例子:  
1) 设置应用的日志等级/过滤 日志的根据等级动态输出  
2) 应用客户端访问数据库连接池线程池大小的切换  
3) 针对当前应用是否使用风控/黑白名单检测  
4) 远程调用/内部调用切换开关  
5) 切换远程调用的协议  
6) 生产测试开发切换开关  
7) 应用是否使用本地或外部缓存  
8) 百分比 阈值的变更  
9) 磁盘写满 清理磁盘文件缓存或删除无用文件操作  

### 3.4 业务开关
通过开关的改变对业务的一些需要变更的情况 能够实时的一键切换 同时也解决了一些一次性需求 减少开发任务 以及一些代码逻辑块算法块上的控制走那条策略  
场景例子:  
1) 设置库存最大上限/每人每日限购等一些需要动态改变的参数  
2) 关闭/更改抢购/限时活动接口  
3) 设置打折力度 优惠券获得或使用方式  
4) 支付/物流方式更换 比如支付宝微信银联关闭或开放  
5) 商品推荐 走推荐引擎或随机推荐等  
6) 推荐引擎使用什么算法计算 离线计算使用什么算法  


### 3.5 降级开关
当某个子系统或应用出现问题时 通过开关或降级操作能保证整个大系统可继续使用  
场景例子:   
1) 风控系统出现问题 不影响业务 通过开关设置返回成功状态码 使得其他系统正常运行  
2) 使用中间件/数据库持久化数据的传递 等其系统修复后 恢复中间件上的数据 


 <a href="subject-2.md">上一章节</a>  <a href="subject-4.md">下一章节</a>